---
import WeeklyOverview from '../components/WeeklyOverview.jsx';
import spots from "../data/spots_with_wind_top50.json"; // deze moet in src/data blijven voor build

// ✅ Tijdens build: alle mogelijke spotId's doorgeven aan Astro
export async function getStaticPaths() {
  return spots.map((spot) => ({
    params: { spotId: spot.spotId },
  }));
}

const { spotId } = Astro.params;

// ✅ Tijdens runtime: forecast-data uit public ophalen
let forecastData = [];
try {
  forecastData = await fetch(`/data/forecastData/${spotId}.json`)
    .then(res => res.ok ? res.json() : []);
} catch (err) {
  console.error(`Kon forecastData niet laden voor ${spotId}`, err);
}
---

<html lang="nl">
  <head>
    <style is:global>
      @import "../styles/global.css";
    </style>
    <meta charset="UTF-8" />
    <title>Kitesurf Voorspelling – {spotId}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="bg-amber-50 font-sans text-gray-800 min-h-screen">
    <header class="bg-cyan-700 text-white text-center p-4">
      <h1 class="text-2xl md:text-3xl font-semibold">
        Kitesurf Voorspelling – {spotId}
      </h1>
    </header>

    <main class="px-4 md:px-12 lg:px-24 py-6">
      <WeeklyOverview client:only="react" forecastData={forecastData} spotId={spotId} />
    </main>
  </body>
</html>
